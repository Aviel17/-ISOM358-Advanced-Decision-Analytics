Attribute VB_Name = "Module9"
Sub AddNames()
'
' AddNames Macro
'
    'Wherever there is a "1", replace with the cooresponding name in the row
    Range("E9:AW9").Select
    Selection.Replace What:="1", Replacement:="=$B$9", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E10:AW10").Select
    Selection.Replace What:="1", Replacement:="=$B$10", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E11:AW11").Select
    Selection.Replace What:="1", Replacement:="=$B$11", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2

    Range("E12:AW12").Select
    Selection.Replace What:="1", Replacement:="=$B$12", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E13:AW13").Select
    Selection.Replace What:="1", Replacement:="=$B$13", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E14:AW14").Select
    Selection.Replace What:="1", Replacement:="=$B$14", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E15:AW15").Select
    Selection.Replace What:="1", Replacement:="=$B$15", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E16:AW16").Select
    Selection.Replace What:="1", Replacement:="=$B$16", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E17:AW17").Select
    Selection.Replace What:="1", Replacement:="=$B$17", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E18:AW18").Select
    Selection.Replace What:="1", Replacement:="=$B$18", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E19:AW19").Select
    Selection.Replace What:="1", Replacement:="=$B$19", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E20:AW20").Select
    Selection.Replace What:="1", Replacement:="=$B$20", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E21:AW21").Select
    Selection.Replace What:="1", Replacement:="=$B$21", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E22:AW22").Select
    Selection.Replace What:="1", Replacement:="=$B$22", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E23:AW23").Select
    Selection.Replace What:="1", Replacement:="=$B$23", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E24:AW24").Select
    Selection.Replace What:="1", Replacement:="=$B$24", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E25:AW25").Select
    Selection.Replace What:="1", Replacement:="=$B$25", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E26:AW26").Select
    Selection.Replace What:="1", Replacement:="=$B$26", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E27:AW27").Select
    Selection.Replace What:="1", Replacement:="=$B$27", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E28:AW28").Select
    Selection.Replace What:="1", Replacement:="=$B$28", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E29:AW29").Select
    Selection.Replace What:="1", Replacement:="=$B$29", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E30:AW30").Select
    Selection.Replace What:="1", Replacement:="=$B$30", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E31:AW31").Select
    Selection.Replace What:="1", Replacement:="=$B$31", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E32:AW32").Select
    Selection.Replace What:="1", Replacement:="=$B$32", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E33:AW33").Select
    Selection.Replace What:="1", Replacement:="=$B$33", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E34:AW34").Select
    Selection.Replace What:="1", Replacement:="=$B$34", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E35:AW35").Select
    Selection.Replace What:="1", Replacement:="=$B$35", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E36:AW36").Select
    Selection.Replace What:="1", Replacement:="=$B$36", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E37:AW37").Select
    Selection.Replace What:="1", Replacement:="=$B$37", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    Range("E38:AW38").Select
    Selection.Replace What:="1", Replacement:="=$B$38", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
        
    ''''''''''''''''''''''''''''''''
    'Run ALL methods in this Module
    RemoveZeros
    ResizeColumns
    TransposeAndFormat
    FixMergeIssue
    TransferToFinal_Schedule
    TransferContactInfo
    HighlightListedValues
    ''''''''''''''''''''''''''''''''

End Sub

Sub RemoveZeros()
'
' RemoveZeros Macro (make sure it's set to xlWhole, not xlPart!)
'
    Range("E9:AW38").Select
    Selection.Replace What:="0", Replacement:="", LookAt:=xlWhole, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
End Sub
Sub ResizeColumns()
'
' ResizeColumns Macro
'
    Range("E8:AW38").Select
    Selection.Columns.AutoFit
End Sub

Sub TransposeAndFormat()
'
' TransposeAndFormat Macro
'
    Range("E7:AW38").Select
    Selection.Copy
    Range("E47").Select
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True

    Range("G47:AK91").Select
    Application.CutCopyMode = False
    Selection.Merge True
    
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    
    Range("F56:F64").Select
    Selection.Replace What:="m2", Replacement:="m", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
    Range("F65:F73").Select
    Selection.Replace What:="m3", Replacement:="m", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
    Range("F74:F82").Select
    Selection.Replace What:="m4", Replacement:="m", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
    Range("F83:F91").Select
    Selection.Replace What:="m5", Replacement:="m", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False, FormulaVersion:=xlReplaceFormula2
End Sub
Sub FixMergeIssue()
'
' FixMergeIssue Macro
'
    Application.DisplayAlerts = False
    Columns("E:E").EntireColumn.AutoFit
    Range("E47:F91").Select
    Selection.Cut
    Range("D47").Select
    ActiveSheet.Paste
    Range("G47:AK91").Select
    Selection.Cut
    Range("F47").Select
    ActiveSheet.Paste
    Columns("F:F").EntireColumn.AutoFit
    Range("K46").Select
End Sub
Sub TransferToFinal_Schedule()
'
' TransferToFinal_Schedule Macro
'
    Sheets("Solver_Blackbox").Select
    Range("D47:F91").Select
    Selection.Copy
    Sheets("Final_Schedule").Select
    Sheets("Final_Schedule").Range("B4").PasteSpecial Paste:=xlPasteValues
    Selection.Columns.AutoFit
    Range("B2").Select
    Selection.Font.Bold = True
    ActiveCell.FormulaR1C1 = "Final Weekly Schedule"
    Range("B4:D12").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B13:D21").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    Range("B22:D30").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B31:D39").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    Range("B40:D48").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    
End Sub

Sub TransferContactInfo()

Sheets("Final_Schedule").Select
Range("G2").Select
    Selection.Font.Bold = True
    ActiveCell.FormulaR1C1 = "Contact Info"
    Range("G3").Select
    Sheets("Solver_Blackbox").Select
    Range("B8:D38").Select
    Selection.Copy
    Sheets("Final_Schedule").Select
    ActiveSheet.Paste
    Selection.Columns.AutoFit
    Range("G3").Select
    ActiveCell.FormulaR1C1 = "Name"
    ActiveCell.FormulaR1C1 = "Email"
    Range("I3").Select
    
End Sub

Public Sub HighlightListedValues()
    Dim strConcatList As String
    Dim cell As Range

    'Creates a string concatenating your list of strings, separated by |s
    'e.g. "item1|item2|item3|item4|"
    
    For Each cell In Sheets("Final_Schedule").Range("G4:G33")
        strConcatList = strConcatList & cell.Value & "|"
    Next cell


    'For each used cell in Column A of sheet1, check whether the value in that cell
    'is contained within the concatenated string
    
    For Each cell In Intersect(Sheets("Final_Schedule").Range("D4:D48"), Sheets("Final_Schedule").UsedRange)
        If InStr(strConcatList, cell.Value) > 0 Then       'InStr returns 0 if the string isn't found
            cell.Interior.Color = RGB(255, 255, 51) 'Highlights the row in yellow if value found
        End If
    Next cell
    
End Sub

